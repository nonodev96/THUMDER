;*********** WINDLX EX.1: GREATEST COMMON MEASURE   *************
;*********** (C) 1991 GÃœNTHER RAIDL		            *************
;*********** MODIFIED 1992 MAZIAR KHOSRAVIPOUR	    *************

;------------------------------------------------------------------------
; PROGRAM BEGINS AT SYMBOL MAIN
; REQUIRES MODULE INPUT
; READ TWO POSITIVE INTEGER NUMBERS FROM STDIN,  CALCULATE THE GCM
; AND WRITE THE RESULT TO STDOUT
;------------------------------------------------------------------------

		.DATA

		;*** PROMPTS FOR INPUT
PROMPT1:	    .ASCIIZ 	"FIRST NUMBER:"
PROMPT2:	    .ASCIIZ 	"SECOND NUMBER: "

		;*** DATA FOR PRINTF-TRAP
PRINTFFORMAT:	.ASCIIZ 	"GCM=%D\N\N"
		        .ALIGN		2
PRINTFPAR:	    .WORD		PRINTFFORMAT
PRINTFVALUE:	.SPACE		4


		.TEXT
		.GLOBAL	MAIN
MAIN:
		;*** READ TWO POSITIVE INTEGER NUMBERS INTO R1 AND R2
		ADDI		R1, R0, PROMPT1
		JAL		    INPUTUNSIGNED	;READ UNS.-INTEGER INTO R1
		ADD		    R2, R1, R0	;R2 <- R1
		ADDI		R1, R0, PROMPT2
		JAL		    INPUTUNSIGNED	;READ UNS.-INTEGER INTO R1

LOOP:		;*** COMPARE R1 AND R2
		SEQ		    R3, R1, R2	;R1 == R2 ?
		BNEZ		R3, RESULT	
		SGT		    R3, R1, R2	;R1 > R2 ?
		BNEZ		R3, R1GREATER
		
R2GREATER:	;*** SUBTRACT R1 FROM R2
		SUB		    R2, R2, R1
		J		    LOOP

R1GREATER:	;*** SUBTRACT R2 FROM R1
		SUB		    R1, R1, R2
		J		    LOOP

RESULT: 	;*** WRITE THE RESULT (R1)
		SW		    PRINTFVALUE, R1
		ADDI		R14, R0, PRINTFPAR
		TRAP		5

		;*** END
		TRAP		0
